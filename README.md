features added from the second branch for the second code
